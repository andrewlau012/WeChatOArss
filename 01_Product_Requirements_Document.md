# 微信公众号RSS订阅服务 - 产品需求文档 (PRD)

## 1. 产品概述
### 1.1 背景
当前微信公众号生态封闭，内容无法通过RSS等开放协议订阅。市场上缺乏长期稳定、低成本且支持私有化部署的解决方案。目标用户（开发者/技术人员）需要一个能够掌控数据、稳定获取关注列表更新并生成RSS源的工具。

### 1.2 目标
构建一个支持Docker私有化部署的微信公众号RSS服务，利用“微信读书”网页版接口降低风控风险，实现长期稳定的公众号内容抓取与RSS生成。

### 1.3 核心价值
- **稳定性**：基于微信读书（Weread）接口，相比直接爬取MP平台或搜狗入口，稳定性极高。
- **低成本**：无需购买昂贵的代理池，仅需普通微信号即可运行。
- **隐私与掌控**：数据本地存储，RSS源地址私有，支持全文输出。

## 2. 用户角色
- **管理员/用户**：拥有部署权限，负责扫码登录、管理公众号列表、配置抓取频率。

## 3. 功能需求

### 3.1 账号管理
| ID | 功能点 | 描述 | 优先级 |
|---|---|---|---|
| A01 | 扫码登录 | 用户通过微信App扫描系统生成的“微信读书”登录二维码。 | P0 |
| A02 | 状态保活 | 系统自动刷新Cookie/Token，维持登录状态；失效时通过邮件/WebHook通知。 | P0 |
| A03 | 状态检测 | 自动检测微信读书账号状态（是否被风控/限制访问），并在前端明显提示。 | P0 |
| A04 | 多账号轮换 | 支持添加多个微信账号（本期支持2个），系统自动轮询使用以降低单号频率。 | P1 |

### 3.2 公众号源管理
| ID | 功能点 | 描述 | 优先级 |
|---|---|---|---|
| S01 | 列表同步 | 自动同步登录账号在微信读书/微信关注的公众号列表。 | P0 |
| S02 | 关键词搜索添加 | 通过关键词搜索公众号（调用微信读书搜索接口），展示结果并支持添加到抓取列表。 | P0 |
| S03 | 链接解析添加 | 用户粘贴任意公众号文章链接，系统自动解析出所属公众号信息（名称、BizID）并添加到抓取列表。 | P0 |
| S04 | 屏蔽/过滤 | 支持黑名单，排除不需要生成RSS的公众号。 | P2 |

### 3.3 内容抓取与处理
| ID | 功能点 | 描述 | 优先级 |
|---|---|---|---|
| C01 | 定时抓取 | 每日08:15、12:30自动触发增量抓取任务。 | P0 |
| C02 | 全文解析 | 访问文章详情页，提取正文HTML，保留基础格式（图片、加粗等）。 | P0 |
| C03 | 数据留存 | 每个公众号默认仅保留最近 60 天的文章数据，过期自动清理以节省空间。 | P1 |
| C04 | 图片代理 | (可选) 解决微信图片防盗链问题，提供本地/中转图片代理服务。 | P1 |

### 3.4 RSS输出
| ID | 功能点 | 描述 | 优先级 |
|---|---|---|---|
| R01 | 聚合RSS | 生成所有关注公众号的聚合RSS Feed。 | P1 |
| R02 | 单号RSS | 为每个公众号生成独立的RSS Feed地址。 | P0 |
| R03 | 输出条目限制 | RSS Feed 默认最大输出最近 20 篇文章。 | P1 |
| R04 | 格式兼容 | 支持RSS 2.0及Atom格式，兼容主流阅读器（Feedly, Reeder等）。 | P0 |

### 3.5 系统配置
| ID | 功能点 | 描述 | 优先级 |
|---|---|---|---|
| D01 | 环境变量 | 支持通过Docker ENV配置端口、定时任务表达式、数据保留天数等。 | P0 |
| D02 | 数据持久化 | 文章元数据与正文缓存至SQLite/PostgreSQL。 | P0 |

## 4. 非功能需求
- **性能**：支持300+公众号订阅，单次全量更新耗时控制在30分钟内（需控制速率）。
- **稳定性**：自动重试机制，网络抖动不丢数据。
- **安全性**：RSS地址支持Token鉴权（可选），防止恶意消耗流量。
